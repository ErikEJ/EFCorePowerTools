using EFCorePowerTools.Contracts.Views;
using EFCorePowerTools.Extensions;
using EFCorePowerTools.Helpers;
using EFCorePowerTools.Shared.Models;
using EnvDTE;
using Microsoft.VisualStudio.Data.Services;
using Microsoft.VisualStudio.Shell;
using System;
using System.Collections.Generic;
using System.Diagnostics;
using System.Linq;
using System.Threading.Tasks;

namespace EFCorePowerTools.Handlers.Compare
{
    internal class CompareHandler
    {
        private readonly EFCorePowerToolsPackage _package;

        public CompareHandler(EFCorePowerToolsPackage package)
        {
            _package = package;
        }

        public async System.Threading.Tasks.Task HandleComparisonAsync(string outputPath, Project project)
        {
            await ThreadHelper.JoinableTaskFactory.SwitchToMainThreadAsync();

            EnvDteHelper.ShowError("This feature is currently in early preview, please consult release notes for advice.");

            try
            {
                var dteH = new EnvDteHelper();

                if (_package.Dte2.Mode == vsIDEMode.vsIDEModeDebug)
                {
                    EnvDteHelper.ShowError("Cannot compare context to database while debugging");
                    return;
                }

                if (project == null)
                {
                    throw new ArgumentNullException(nameof(project));
                }

                if (project.Properties.Item("TargetFrameworkMoniker") == null)
                {
                    EnvDteHelper.ShowError("The selected project type has no TargetFrameworkMoniker");
                    return;
                }

                if (!project.IsNetCore30OrHigher())
                {
                    EnvDteHelper.ShowError("Only .NET Core 3.0+ projects are supported - TargetFrameworkMoniker: " + project.Properties.Item("TargetFrameworkMoniker").Value);
                    return;
                }

                var result = await project.ContainsEfCoreDesignReferenceAsync();

                if (!result.Item1)
                {
                    if (!Version.TryParse(result.Item2, out Version version))
                    {
                        EnvDteHelper.ShowError($"Cannot support version {result.Item2}, notice that previews have limited supported. You can try to manually install Microsoft.EntityFrameworkCore.Design preview.");
                        return;
                    }

                    if (version.Major != 5)
                    {
                        EnvDteHelper.ShowError($"Only EF Core 5 is supported.");
                        return;
                    }

                    var nugetHelper = new NuGetHelper();
                    nugetHelper.InstallPackage("Microsoft.EntityFrameworkCore.Design", project, version);
                    EnvDteHelper.ShowError($"Installing EFCore.Design version {version}, please retry the command");
                    return;
                }

                _package.Dte2.StatusBar.Text = "Loading data";
                object icon = (short)Microsoft.VisualStudio.Shell.Interop.Constants.SBAI_Build;
                _package.Dte2.StatusBar.Animate(true, icon);

                //TODO Limit to SQL Server provider connections
                var databaseList = VsDataHelper.GetDataConnections(_package);
                var contextTypes = await GetDbContextTypesAsync(outputPath, project);

                var optionsDialog = _package.GetView<ICompareOptionsDialog>();

                if (databaseList != null && databaseList.Any())
                {
                    optionsDialog.AddConnections(databaseList.Select(m => new DatabaseConnectionModel
                    {
                        ConnectionName = m.Value.Caption,
                        ConnectionString = m.Value.ConnectionString,
                        DatabaseType = m.Value.DatabaseType,
                        DataConnection = m.Value.DataConnection,
                    }));
                }

                optionsDialog.AddContextTypes(contextTypes);

                _package.Dte2.StatusBar.Animate(false, icon);
                _package.Dte2.StatusBar.Clear();
                var pickDataSourceResult = optionsDialog.ShowAndAwaitUserResponse(true);
                if (!pickDataSourceResult.ClosedByOK)
                    return;

                pickDataSourceResult.Payload.Connection.DataConnection.Open();
                pickDataSourceResult.Payload.Connection.ConnectionString = DataProtection.DecryptString(pickDataSourceResult.Payload.Connection.DataConnection.EncryptedConnectionString);

                _package.Dte2.StatusBar.Text = "Comparing database with context(s)...";
                _package.Dte2.StatusBar.Animate(true, icon);
                var timer = new Stopwatch();
                timer.Start();
                var comparisonResult = await GetComparisonResultAsync( 
                    outputPath,
                    project,
                    pickDataSourceResult.Payload.Connection, 
                    pickDataSourceResult.Payload.ContextTypes.First());
                timer.Stop();
                _package.Dte2.StatusBar.Animate(false, icon);
                _package.Dte2.StatusBar.Text = $"Compare completed in {timer.Elapsed:h\\:mm\\:ss}";
                
                if (comparisonResult.Any())
                {
                    var resultDialog = _package.GetView<ICompareResultDialog>();
                    resultDialog.AddComparisonResult(comparisonResult);
                    resultDialog.ShowAndAwaitUserResponse(true);
                }
                else
                {
                    EnvDteHelper.ShowMessage("Context(s) and database structure match");
                }

                _package.Dte2.StatusBar.Clear();

                Telemetry.TrackEvent("PowerTools.Compare");
            }
            catch (AggregateException ae)
            {
                foreach (var innerException in ae.Flatten().InnerExceptions)
                {
                    _package.LogError(new List<string>(), innerException);
                }
            }
            catch (Exception exception)
            {
                _package.LogError(new List<string>(), exception);
            }
        }

        private async Task<IEnumerable<string>> GetDbContextTypesAsync(string outputPath, Project project)
        {
            var processLauncher = new ProcessLauncher(project);

            var processResult = await processLauncher.GetOutputAsync(outputPath, GenerationType.DbContextList, null);

            if (string.IsNullOrEmpty(processResult))
            {
                throw new ArgumentException("Unable to collect DbContext information", nameof(processResult));
            }

            if (processResult.StartsWith("Error:"))
            {
                throw new ArgumentException(processResult, nameof(processResult));
            }

            var modelResults = processLauncher.BuildModelResult(processResult);
            var result = new List<string>();

            foreach (var modelResult in modelResults)
            {
                result.Add(modelResult.Item1);
            }

            return result;
        }

        private async Task<IEnumerable<CompareLogModel>> GetComparisonResultAsync(string outputPath, 
            Project project, 
            DatabaseConnectionModel connection, 
            string contextName)
        {
            var processLauncher = new ProcessLauncher(project);

            var processResult = await processLauncher.GetOutputAsync(outputPath, GenerationType.DbContextCompare, contextName, connection.ConnectionString);

            if (string.IsNullOrEmpty(processResult))
            {
                throw new ArgumentException("Unable to collect SchemaCompare information", nameof(processResult));
            }

            if (processResult.StartsWith("Error:"))
            {
                throw new ArgumentException(processResult, nameof(processResult));
            }

            var modelResults = processLauncher.BuildModelResult(processResult);

            return Newtonsoft.Json.JsonConvert.DeserializeObject<List<CompareLogModel>>(modelResults.First().Item2);

            //var s = "[{\"SubLogs\":[{\"SubLogs\":[],\"Type\":3,\"State\":4,\"Name\":\"Category\",\"Attribute\":9,\"Expected\":\"Categories\",\"Found\":null},{\"SubLogs\":[{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"CustomerId\",\"Attribute\":0,\"Expected\":\"CustomerID\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"Address\",\"Attribute\":0,\"Expected\":\"Address\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":3,\"Name\":\"City\",\"Attribute\":3,\"Expected\":\"nvarchar(15)\",\"Found\":\"nvarchar(16)\"},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"CompanyName\",\"Attribute\":0,\"Expected\":\"CompanyName\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"ContactName\",\"Attribute\":0,\"Expected\":\"ContactName\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"ContactTitle\",\"Attribute\":0,\"Expected\":\"ContactTitle\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"Country\",\"Attribute\":0,\"Expected\":\"Country\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"Fax\",\"Attribute\":0,\"Expected\":\"Fax\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"Phone\",\"Attribute\":0,\"Expected\":\"Phone\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"PostalCode\",\"Attribute\":0,\"Expected\":\"PostalCode\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"Region\",\"Attribute\":0,\"Expected\":\"Region\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"Timestamp\",\"Attribute\":0,\"Expected\":\"Timestamp\",\"Found\":null},{\"SubLogs\":[],\"Type\":8,\"State\":1,\"Name\":\"PK_Customers\",\"Attribute\":0,\"Expected\":\"PK_Customers\",\"Found\":null},{\"SubLogs\":[],\"Type\":10,\"State\":1,\"Name\":\"City\",\"Attribute\":0,\"Expected\":\"City\",\"Found\":null},{\"SubLogs\":[],\"Type\":10,\"State\":1,\"Name\":\"CompanyName\",\"Attribute\":0,\"Expected\":\"CompanyName\",\"Found\":null},{\"SubLogs\":[],\"Type\":10,\"State\":1,\"Name\":\"PostalCode\",\"Attribute\":0,\"Expected\":\"PostalCode\",\"Found\":null},{\"SubLogs\":[],\"Type\":10,\"State\":1,\"Name\":\"Region\",\"Attribute\":0,\"Expected\":\"Region\",\"Found\":null}],\"Type\":3,\"State\":1,\"Name\":\"Customer\",\"Attribute\":0,\"Expected\":\"Customers\",\"Found\":null},{\"SubLogs\":[{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"CustomerId\",\"Attribute\":0,\"Expected\":\"CustomerID\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"CustomerTypeId\",\"Attribute\":0,\"Expected\":\"CustomerTypeID\",\"Found\":null},{\"SubLogs\":[],\"Type\":8,\"State\":1,\"Name\":\"PK_CustomerCustomerDemo\",\"Attribute\":0,\"Expected\":\"PK_CustomerCustomerDemo\",\"Found\":null},{\"SubLogs\":[],\"Type\":10,\"State\":4,\"Name\":\"CustomerTypeID\",\"Attribute\":12,\"Expected\":\"IX_CustomerCustomerDemo_CustomerTypeID\",\"Found\":null}],\"Type\":3,\"State\":1,\"Name\":\"CustomerCustomerDemo\",\"Attribute\":0,\"Expected\":\"CustomerCustomerDemo\",\"Found\":null},{\"SubLogs\":[{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"CustomerTypeId\",\"Attribute\":0,\"Expected\":\"CustomerTypeID\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"CustomerDesc\",\"Attribute\":0,\"Expected\":\"CustomerDesc\",\"Found\":null},{\"SubLogs\":[],\"Type\":8,\"State\":1,\"Name\":\"PK_CustomerDemographics\",\"Attribute\":0,\"Expected\":\"PK_CustomerDemographics\",\"Found\":null}],\"Type\":3,\"State\":1,\"Name\":\"CustomerDemographic\",\"Attribute\":0,\"Expected\":\"CustomerDemographics\",\"Found\":null},{\"SubLogs\":[{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"EmployeeId\",\"Attribute\":0,\"Expected\":\"EmployeeID\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"Address\",\"Attribute\":0,\"Expected\":\"Address\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"BirthDate\",\"Attribute\":0,\"Expected\":\"BirthDate\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"City\",\"Attribute\":0,\"Expected\":\"City\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"Country\",\"Attribute\":0,\"Expected\":\"Country\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"Extension\",\"Attribute\":0,\"Expected\":\"Extension\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"FirstName\",\"Attribute\":0,\"Expected\":\"FirstName\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"HireDate\",\"Attribute\":0,\"Expected\":\"HireDate\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"HomePhone\",\"Attribute\":0,\"Expected\":\"HomePhone\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"LastName\",\"Attribute\":0,\"Expected\":\"LastName\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"Notes\",\"Attribute\":0,\"Expected\":\"Notes\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"Photo\",\"Attribute\":0,\"Expected\":\"Photo\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"PhotoPath\",\"Attribute\":0,\"Expected\":\"PhotoPath\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"PostalCode\",\"Attribute\":0,\"Expected\":\"PostalCode\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"Region\",\"Attribute\":0,\"Expected\":\"Region\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"ReportsTo\",\"Attribute\":0,\"Expected\":\"ReportsTo\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"Title\",\"Attribute\":0,\"Expected\":\"Title\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"TitleOfCourtesy\",\"Attribute\":0,\"Expected\":\"TitleOfCourtesy\",\"Found\":null},{\"SubLogs\":[],\"Type\":8,\"State\":1,\"Name\":\"PK_Employees\",\"Attribute\":0,\"Expected\":\"PK_Employees\",\"Found\":null},{\"SubLogs\":[],\"Type\":9,\"State\":1,\"Name\":\"FK_Employees_Employees\",\"Attribute\":0,\"Expected\":\"FK_Employees_Employees\",\"Found\":null},{\"SubLogs\":[],\"Type\":10,\"State\":4,\"Name\":\"ReportsTo\",\"Attribute\":12,\"Expected\":\"IX_Employees_ReportsTo\",\"Found\":null},{\"SubLogs\":[],\"Type\":10,\"State\":1,\"Name\":\"LastName\",\"Attribute\":0,\"Expected\":\"LastName\",\"Found\":null},{\"SubLogs\":[],\"Type\":10,\"State\":4,\"Name\":\"PostalCode\",\"Attribute\":12,\"Expected\":\"PostalCode1\",\"Found\":null}],\"Type\":3,\"State\":1,\"Name\":\"Employee\",\"Attribute\":0,\"Expected\":\"Employees\",\"Found\":null},{\"SubLogs\":[{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"EmployeeId\",\"Attribute\":0,\"Expected\":\"EmployeeID\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"TerritoryId\",\"Attribute\":0,\"Expected\":\"TerritoryID\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"Date\",\"Attribute\":0,\"Expected\":\"Date\",\"Found\":null},{\"SubLogs\":[],\"Type\":8,\"State\":1,\"Name\":\"PK_EmployeeTerritories\",\"Attribute\":0,\"Expected\":\"PK_EmployeeTerritories\",\"Found\":null},{\"SubLogs\":[],\"Type\":10,\"State\":4,\"Name\":\"TerritoryID\",\"Attribute\":12,\"Expected\":\"IX_EmployeeTerritories_TerritoryID\",\"Found\":null}],\"Type\":3,\"State\":1,\"Name\":\"EmployeeTerritory\",\"Attribute\":0,\"Expected\":\"EmployeeTerritories\",\"Found\":null},{\"SubLogs\":[{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"OrderId\",\"Attribute\":0,\"Expected\":\"OrderID\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"CustomerId\",\"Attribute\":0,\"Expected\":\"CustomerID\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"EmployeeId\",\"Attribute\":0,\"Expected\":\"EmployeeID\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"Freight\",\"Attribute\":0,\"Expected\":\"Freight\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"OrderDate\",\"Attribute\":0,\"Expected\":\"OrderDate\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"RequiredDate\",\"Attribute\":0,\"Expected\":\"RequiredDate\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"ShipAddress\",\"Attribute\":0,\"Expected\":\"ShipAddress\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"ShipCity\",\"Attribute\":0,\"Expected\":\"ShipCity\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"ShipCountry\",\"Attribute\":0,\"Expected\":\"ShipCountry\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"ShipName\",\"Attribute\":0,\"Expected\":\"ShipName\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"ShipPostalCode\",\"Attribute\":0,\"Expected\":\"ShipPostalCode\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"ShipRegion\",\"Attribute\":0,\"Expected\":\"ShipRegion\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"ShipVia\",\"Attribute\":0,\"Expected\":\"ShipVia\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"ShippedDate\",\"Attribute\":0,\"Expected\":\"ShippedDate\",\"Found\":null},{\"SubLogs\":[],\"Type\":8,\"State\":1,\"Name\":\"PK_Orders\",\"Attribute\":0,\"Expected\":\"PK_Orders\",\"Found\":null},{\"SubLogs\":[],\"Type\":9,\"State\":1,\"Name\":\"FK_Orders_Shippers\",\"Attribute\":0,\"Expected\":\"FK_Orders_Shippers\",\"Found\":null},{\"SubLogs\":[],\"Type\":10,\"State\":1,\"Name\":\"CustomerID\",\"Attribute\":0,\"Expected\":\"CustomerID\",\"Found\":null},{\"SubLogs\":[],\"Type\":10,\"State\":1,\"Name\":\"CustomerID\",\"Attribute\":0,\"Expected\":\"CustomersOrders\",\"Found\":null},{\"SubLogs\":[],\"Type\":10,\"State\":1,\"Name\":\"EmployeeID\",\"Attribute\":0,\"Expected\":\"EmployeeID\",\"Found\":null},{\"SubLogs\":[],\"Type\":10,\"State\":1,\"Name\":\"EmployeeID\",\"Attribute\":0,\"Expected\":\"EmployeesOrders\",\"Found\":null},{\"SubLogs\":[],\"Type\":10,\"State\":1,\"Name\":\"OrderDate\",\"Attribute\":0,\"Expected\":\"OrderDate\",\"Found\":null},{\"SubLogs\":[],\"Type\":10,\"State\":1,\"Name\":\"ShipPostalCode\",\"Attribute\":0,\"Expected\":\"ShipPostalCode\",\"Found\":null},{\"SubLogs\":[],\"Type\":10,\"State\":1,\"Name\":\"ShippedDate\",\"Attribute\":0,\"Expected\":\"ShippedDate\",\"Found\":null},{\"SubLogs\":[],\"Type\":10,\"State\":1,\"Name\":\"ShipVia\",\"Attribute\":0,\"Expected\":\"ShippersOrders\",\"Found\":null}],\"Type\":3,\"State\":1,\"Name\":\"Order\",\"Attribute\":0,\"Expected\":\"Orders\",\"Found\":null},{\"SubLogs\":[{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"OrderId\",\"Attribute\":0,\"Expected\":\"OrderID\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"ProductId\",\"Attribute\":0,\"Expected\":\"ProductID\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"Discount\",\"Attribute\":0,\"Expected\":\"Discount\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"Quantity\",\"Attribute\":0,\"Expected\":\"Quantity\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"UnitPrice\",\"Attribute\":0,\"Expected\":\"UnitPrice\",\"Found\":null},{\"SubLogs\":[],\"Type\":8,\"State\":1,\"Name\":\"PK_Order_Details\",\"Attribute\":0,\"Expected\":\"PK_Order_Details\",\"Found\":null},{\"SubLogs\":[],\"Type\":10,\"State\":1,\"Name\":\"OrderID\",\"Attribute\":0,\"Expected\":\"OrderID\",\"Found\":null},{\"SubLogs\":[],\"Type\":10,\"State\":1,\"Name\":\"OrderID\",\"Attribute\":0,\"Expected\":\"OrdersOrder_Details\",\"Found\":null},{\"SubLogs\":[],\"Type\":10,\"State\":1,\"Name\":\"ProductID\",\"Attribute\":0,\"Expected\":\"ProductID\",\"Found\":null},{\"SubLogs\":[],\"Type\":10,\"State\":1,\"Name\":\"ProductID\",\"Attribute\":0,\"Expected\":\"ProductsOrder_Details\",\"Found\":null}],\"Type\":3,\"State\":1,\"Name\":\"OrderDetail\",\"Attribute\":0,\"Expected\":\"Order Details\",\"Found\":null},{\"SubLogs\":[{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"ProductId\",\"Attribute\":0,\"Expected\":\"ProductID\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"CategoryId\",\"Attribute\":0,\"Expected\":\"CategoryID\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"Discontinued\",\"Attribute\":0,\"Expected\":\"Discontinued\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"ProductName\",\"Attribute\":0,\"Expected\":\"ProductName\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"QuantityPerUnit\",\"Attribute\":0,\"Expected\":\"QuantityPerUnit\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"ReorderLevel\",\"Attribute\":0,\"Expected\":\"ReorderLevel\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"SupplierId\",\"Attribute\":0,\"Expected\":\"SupplierID\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"UnitPrice\",\"Attribute\":0,\"Expected\":\"UnitPrice\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"UnitsInStock\",\"Attribute\":0,\"Expected\":\"UnitsInStock\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"UnitsOnOrder\",\"Attribute\":0,\"Expected\":\"UnitsOnOrder\",\"Found\":null},{\"SubLogs\":[],\"Type\":8,\"State\":1,\"Name\":\"PK_Products\",\"Attribute\":0,\"Expected\":\"PK_Products\",\"Found\":null},{\"SubLogs\":[],\"Type\":9,\"State\":1,\"Name\":\"FK_Products_Categories\",\"Attribute\":0,\"Expected\":\"FK_Products_Categories\",\"Found\":null},{\"SubLogs\":[],\"Type\":10,\"State\":1,\"Name\":\"CategoryID\",\"Attribute\":0,\"Expected\":\"CategoriesProducts\",\"Found\":null},{\"SubLogs\":[],\"Type\":10,\"State\":1,\"Name\":\"CategoryID\",\"Attribute\":0,\"Expected\":\"CategoryID\",\"Found\":null},{\"SubLogs\":[],\"Type\":10,\"State\":1,\"Name\":\"ProductName\",\"Attribute\":0,\"Expected\":\"ProductName\",\"Found\":null},{\"SubLogs\":[],\"Type\":10,\"State\":1,\"Name\":\"SupplierID\",\"Attribute\":0,\"Expected\":\"SupplierID\",\"Found\":null},{\"SubLogs\":[],\"Type\":10,\"State\":1,\"Name\":\"SupplierID\",\"Attribute\":0,\"Expected\":\"SuppliersProducts\",\"Found\":null}],\"Type\":3,\"State\":1,\"Name\":\"Product\",\"Attribute\":0,\"Expected\":\"Products\",\"Found\":null},{\"SubLogs\":[{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"RegionId\",\"Attribute\":0,\"Expected\":\"RegionID\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"RegionDescription\",\"Attribute\":0,\"Expected\":\"RegionDescription\",\"Found\":null},{\"SubLogs\":[],\"Type\":8,\"State\":1,\"Name\":\"PK_Region\",\"Attribute\":0,\"Expected\":\"PK_Region\",\"Found\":null}],\"Type\":3,\"State\":1,\"Name\":\"Region\",\"Attribute\":0,\"Expected\":\"Region\",\"Found\":null},{\"SubLogs\":[{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"ShipperId\",\"Attribute\":0,\"Expected\":\"ShipperID\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"CompanyName\",\"Attribute\":0,\"Expected\":\"CompanyName\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"Phone\",\"Attribute\":0,\"Expected\":\"Phone\",\"Found\":null},{\"SubLogs\":[],\"Type\":8,\"State\":1,\"Name\":\"PK_Shippers\",\"Attribute\":0,\"Expected\":\"PK_Shippers\",\"Found\":null}],\"Type\":3,\"State\":1,\"Name\":\"Shipper\",\"Attribute\":0,\"Expected\":\"Shippers\",\"Found\":null},{\"SubLogs\":[{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"SupplierId\",\"Attribute\":0,\"Expected\":\"SupplierID\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"Address\",\"Attribute\":0,\"Expected\":\"Address\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"City\",\"Attribute\":0,\"Expected\":\"City\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"CompanyName\",\"Attribute\":0,\"Expected\":\"CompanyName\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"ContactName\",\"Attribute\":0,\"Expected\":\"ContactName\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"ContactTitle\",\"Attribute\":0,\"Expected\":\"ContactTitle\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"Country\",\"Attribute\":0,\"Expected\":\"Country\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"Fax\",\"Attribute\":0,\"Expected\":\"Fax\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"HomePage\",\"Attribute\":0,\"Expected\":\"HomePage\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"Phone\",\"Attribute\":0,\"Expected\":\"Phone\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"PostalCode\",\"Attribute\":0,\"Expected\":\"PostalCode\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"Region\",\"Attribute\":0,\"Expected\":\"Region\",\"Found\":null},{\"SubLogs\":[],\"Type\":8,\"State\":1,\"Name\":\"PK_Suppliers\",\"Attribute\":0,\"Expected\":\"PK_Suppliers\",\"Found\":null},{\"SubLogs\":[],\"Type\":10,\"State\":4,\"Name\":\"CompanyName\",\"Attribute\":12,\"Expected\":\"CompanyName1\",\"Found\":null},{\"SubLogs\":[],\"Type\":10,\"State\":4,\"Name\":\"PostalCode\",\"Attribute\":12,\"Expected\":\"PostalCode2\",\"Found\":null}],\"Type\":3,\"State\":1,\"Name\":\"Supplier\",\"Attribute\":0,\"Expected\":\"Suppliers\",\"Found\":null},{\"SubLogs\":[{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"TerritoryId\",\"Attribute\":0,\"Expected\":\"TerritoryID\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"RegionId\",\"Attribute\":0,\"Expected\":\"RegionID\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"TerritoryDescription\",\"Attribute\":0,\"Expected\":\"TerritoryDescription\",\"Found\":null},{\"SubLogs\":[],\"Type\":8,\"State\":1,\"Name\":\"PK_Territories\",\"Attribute\":0,\"Expected\":\"PK_Territories\",\"Found\":null},{\"SubLogs\":[],\"Type\":10,\"State\":4,\"Name\":\"RegionID\",\"Attribute\":12,\"Expected\":\"IX_Territories_RegionID\",\"Found\":null}],\"Type\":3,\"State\":1,\"Name\":\"Territory\",\"Attribute\":0,\"Expected\":\"Territories\",\"Found\":null}],\"Type\":2,\"State\":1,\"Name\":\"NorthwindContext\",\"Attribute\":0,\"Expected\":\"NorthwindContext\",\"Found\":null},{\"SubLogs\":[{\"SubLogs\":[],\"Type\":3,\"State\":4,\"Name\":\"Category\",\"Attribute\":9,\"Expected\":\"Categories\",\"Found\":null},{\"SubLogs\":[{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"CustomerId\",\"Attribute\":0,\"Expected\":\"CustomerID\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"Address\",\"Attribute\":0,\"Expected\":\"Address\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":3,\"Name\":\"City\",\"Attribute\":3,\"Expected\":\"nvarchar(15)\",\"Found\":\"nvarchar(16)\"},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"CompanyName\",\"Attribute\":0,\"Expected\":\"CompanyName\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"ContactName\",\"Attribute\":0,\"Expected\":\"ContactName\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"ContactTitle\",\"Attribute\":0,\"Expected\":\"ContactTitle\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"Country\",\"Attribute\":0,\"Expected\":\"Country\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"Fax\",\"Attribute\":0,\"Expected\":\"Fax\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"Phone\",\"Attribute\":0,\"Expected\":\"Phone\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"PostalCode\",\"Attribute\":0,\"Expected\":\"PostalCode\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"Region\",\"Attribute\":0,\"Expected\":\"Region\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"Timestamp\",\"Attribute\":0,\"Expected\":\"Timestamp\",\"Found\":null},{\"SubLogs\":[],\"Type\":8,\"State\":1,\"Name\":\"PK_Customers\",\"Attribute\":0,\"Expected\":\"PK_Customers\",\"Found\":null},{\"SubLogs\":[],\"Type\":10,\"State\":1,\"Name\":\"City\",\"Attribute\":0,\"Expected\":\"City\",\"Found\":null},{\"SubLogs\":[],\"Type\":10,\"State\":1,\"Name\":\"CompanyName\",\"Attribute\":0,\"Expected\":\"CompanyName\",\"Found\":null},{\"SubLogs\":[],\"Type\":10,\"State\":1,\"Name\":\"PostalCode\",\"Attribute\":0,\"Expected\":\"PostalCode\",\"Found\":null},{\"SubLogs\":[],\"Type\":10,\"State\":1,\"Name\":\"Region\",\"Attribute\":0,\"Expected\":\"Region\",\"Found\":null}],\"Type\":3,\"State\":1,\"Name\":\"Customer\",\"Attribute\":0,\"Expected\":\"Customers\",\"Found\":null},{\"SubLogs\":[{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"CustomerId\",\"Attribute\":0,\"Expected\":\"CustomerID\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"CustomerTypeId\",\"Attribute\":0,\"Expected\":\"CustomerTypeID\",\"Found\":null},{\"SubLogs\":[],\"Type\":8,\"State\":1,\"Name\":\"PK_CustomerCustomerDemo\",\"Attribute\":0,\"Expected\":\"PK_CustomerCustomerDemo\",\"Found\":null},{\"SubLogs\":[],\"Type\":10,\"State\":4,\"Name\":\"CustomerTypeID\",\"Attribute\":12,\"Expected\":\"IX_CustomerCustomerDemo_CustomerTypeID\",\"Found\":null}],\"Type\":3,\"State\":1,\"Name\":\"CustomerCustomerDemo\",\"Attribute\":0,\"Expected\":\"CustomerCustomerDemo\",\"Found\":null},{\"SubLogs\":[{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"CustomerTypeId\",\"Attribute\":0,\"Expected\":\"CustomerTypeID\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"CustomerDesc\",\"Attribute\":0,\"Expected\":\"CustomerDesc\",\"Found\":null},{\"SubLogs\":[],\"Type\":8,\"State\":1,\"Name\":\"PK_CustomerDemographics\",\"Attribute\":0,\"Expected\":\"PK_CustomerDemographics\",\"Found\":null}],\"Type\":3,\"State\":1,\"Name\":\"CustomerDemographic\",\"Attribute\":0,\"Expected\":\"CustomerDemographics\",\"Found\":null},{\"SubLogs\":[{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"EmployeeId\",\"Attribute\":0,\"Expected\":\"EmployeeID\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"Address\",\"Attribute\":0,\"Expected\":\"Address\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"BirthDate\",\"Attribute\":0,\"Expected\":\"BirthDate\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"City\",\"Attribute\":0,\"Expected\":\"City\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"Country\",\"Attribute\":0,\"Expected\":\"Country\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"Extension\",\"Attribute\":0,\"Expected\":\"Extension\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"FirstName\",\"Attribute\":0,\"Expected\":\"FirstName\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"HireDate\",\"Attribute\":0,\"Expected\":\"HireDate\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"HomePhone\",\"Attribute\":0,\"Expected\":\"HomePhone\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"LastName\",\"Attribute\":0,\"Expected\":\"LastName\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"Notes\",\"Attribute\":0,\"Expected\":\"Notes\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"Photo\",\"Attribute\":0,\"Expected\":\"Photo\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"PhotoPath\",\"Attribute\":0,\"Expected\":\"PhotoPath\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"PostalCode\",\"Attribute\":0,\"Expected\":\"PostalCode\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"Region\",\"Attribute\":0,\"Expected\":\"Region\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"ReportsTo\",\"Attribute\":0,\"Expected\":\"ReportsTo\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"Title\",\"Attribute\":0,\"Expected\":\"Title\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"TitleOfCourtesy\",\"Attribute\":0,\"Expected\":\"TitleOfCourtesy\",\"Found\":null},{\"SubLogs\":[],\"Type\":8,\"State\":1,\"Name\":\"PK_Employees\",\"Attribute\":0,\"Expected\":\"PK_Employees\",\"Found\":null},{\"SubLogs\":[],\"Type\":9,\"State\":1,\"Name\":\"FK_Employees_Employees\",\"Attribute\":0,\"Expected\":\"FK_Employees_Employees\",\"Found\":null},{\"SubLogs\":[],\"Type\":10,\"State\":4,\"Name\":\"ReportsTo\",\"Attribute\":12,\"Expected\":\"IX_Employees_ReportsTo\",\"Found\":null},{\"SubLogs\":[],\"Type\":10,\"State\":1,\"Name\":\"LastName\",\"Attribute\":0,\"Expected\":\"LastName\",\"Found\":null},{\"SubLogs\":[],\"Type\":10,\"State\":4,\"Name\":\"PostalCode\",\"Attribute\":12,\"Expected\":\"PostalCode1\",\"Found\":null}],\"Type\":3,\"State\":1,\"Name\":\"Employee\",\"Attribute\":0,\"Expected\":\"Employees\",\"Found\":null},{\"SubLogs\":[{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"EmployeeId\",\"Attribute\":0,\"Expected\":\"EmployeeID\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"TerritoryId\",\"Attribute\":0,\"Expected\":\"TerritoryID\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"Date\",\"Attribute\":0,\"Expected\":\"Date\",\"Found\":null},{\"SubLogs\":[],\"Type\":8,\"State\":1,\"Name\":\"PK_EmployeeTerritories\",\"Attribute\":0,\"Expected\":\"PK_EmployeeTerritories\",\"Found\":null},{\"SubLogs\":[],\"Type\":10,\"State\":4,\"Name\":\"TerritoryID\",\"Attribute\":12,\"Expected\":\"IX_EmployeeTerritories_TerritoryID\",\"Found\":null}],\"Type\":3,\"State\":1,\"Name\":\"EmployeeTerritory\",\"Attribute\":0,\"Expected\":\"EmployeeTerritories\",\"Found\":null},{\"SubLogs\":[{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"OrderId\",\"Attribute\":0,\"Expected\":\"OrderID\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"CustomerId\",\"Attribute\":0,\"Expected\":\"CustomerID\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"EmployeeId\",\"Attribute\":0,\"Expected\":\"EmployeeID\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"Freight\",\"Attribute\":0,\"Expected\":\"Freight\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"OrderDate\",\"Attribute\":0,\"Expected\":\"OrderDate\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"RequiredDate\",\"Attribute\":0,\"Expected\":\"RequiredDate\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"ShipAddress\",\"Attribute\":0,\"Expected\":\"ShipAddress\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"ShipCity\",\"Attribute\":0,\"Expected\":\"ShipCity\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"ShipCountry\",\"Attribute\":0,\"Expected\":\"ShipCountry\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"ShipName\",\"Attribute\":0,\"Expected\":\"ShipName\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"ShipPostalCode\",\"Attribute\":0,\"Expected\":\"ShipPostalCode\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"ShipRegion\",\"Attribute\":0,\"Expected\":\"ShipRegion\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"ShipVia\",\"Attribute\":0,\"Expected\":\"ShipVia\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"ShippedDate\",\"Attribute\":0,\"Expected\":\"ShippedDate\",\"Found\":null},{\"SubLogs\":[],\"Type\":8,\"State\":1,\"Name\":\"PK_Orders\",\"Attribute\":0,\"Expected\":\"PK_Orders\",\"Found\":null},{\"SubLogs\":[],\"Type\":9,\"State\":1,\"Name\":\"FK_Orders_Shippers\",\"Attribute\":0,\"Expected\":\"FK_Orders_Shippers\",\"Found\":null},{\"SubLogs\":[],\"Type\":10,\"State\":1,\"Name\":\"CustomerID\",\"Attribute\":0,\"Expected\":\"CustomerID\",\"Found\":null},{\"SubLogs\":[],\"Type\":10,\"State\":1,\"Name\":\"CustomerID\",\"Attribute\":0,\"Expected\":\"CustomersOrders\",\"Found\":null},{\"SubLogs\":[],\"Type\":10,\"State\":1,\"Name\":\"EmployeeID\",\"Attribute\":0,\"Expected\":\"EmployeeID\",\"Found\":null},{\"SubLogs\":[],\"Type\":10,\"State\":1,\"Name\":\"EmployeeID\",\"Attribute\":0,\"Expected\":\"EmployeesOrders\",\"Found\":null},{\"SubLogs\":[],\"Type\":10,\"State\":1,\"Name\":\"OrderDate\",\"Attribute\":0,\"Expected\":\"OrderDate\",\"Found\":null},{\"SubLogs\":[],\"Type\":10,\"State\":1,\"Name\":\"ShipPostalCode\",\"Attribute\":0,\"Expected\":\"ShipPostalCode\",\"Found\":null},{\"SubLogs\":[],\"Type\":10,\"State\":1,\"Name\":\"ShippedDate\",\"Attribute\":0,\"Expected\":\"ShippedDate\",\"Found\":null},{\"SubLogs\":[],\"Type\":10,\"State\":1,\"Name\":\"ShipVia\",\"Attribute\":0,\"Expected\":\"ShippersOrders\",\"Found\":null}],\"Type\":3,\"State\":1,\"Name\":\"Order\",\"Attribute\":0,\"Expected\":\"Orders\",\"Found\":null},{\"SubLogs\":[{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"OrderId\",\"Attribute\":0,\"Expected\":\"OrderID\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"ProductId\",\"Attribute\":0,\"Expected\":\"ProductID\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"Discount\",\"Attribute\":0,\"Expected\":\"Discount\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"Quantity\",\"Attribute\":0,\"Expected\":\"Quantity\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"UnitPrice\",\"Attribute\":0,\"Expected\":\"UnitPrice\",\"Found\":null},{\"SubLogs\":[],\"Type\":8,\"State\":1,\"Name\":\"PK_Order_Details\",\"Attribute\":0,\"Expected\":\"PK_Order_Details\",\"Found\":null},{\"SubLogs\":[],\"Type\":10,\"State\":1,\"Name\":\"OrderID\",\"Attribute\":0,\"Expected\":\"OrderID\",\"Found\":null},{\"SubLogs\":[],\"Type\":10,\"State\":1,\"Name\":\"OrderID\",\"Attribute\":0,\"Expected\":\"OrdersOrder_Details\",\"Found\":null},{\"SubLogs\":[],\"Type\":10,\"State\":1,\"Name\":\"ProductID\",\"Attribute\":0,\"Expected\":\"ProductID\",\"Found\":null},{\"SubLogs\":[],\"Type\":10,\"State\":1,\"Name\":\"ProductID\",\"Attribute\":0,\"Expected\":\"ProductsOrder_Details\",\"Found\":null}],\"Type\":3,\"State\":1,\"Name\":\"OrderDetail\",\"Attribute\":0,\"Expected\":\"Order Details\",\"Found\":null},{\"SubLogs\":[{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"ProductId\",\"Attribute\":0,\"Expected\":\"ProductID\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"CategoryId\",\"Attribute\":0,\"Expected\":\"CategoryID\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"Discontinued\",\"Attribute\":0,\"Expected\":\"Discontinued\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"ProductName\",\"Attribute\":0,\"Expected\":\"ProductName\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"QuantityPerUnit\",\"Attribute\":0,\"Expected\":\"QuantityPerUnit\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"ReorderLevel\",\"Attribute\":0,\"Expected\":\"ReorderLevel\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"SupplierId\",\"Attribute\":0,\"Expected\":\"SupplierID\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"UnitPrice\",\"Attribute\":0,\"Expected\":\"UnitPrice\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"UnitsInStock\",\"Attribute\":0,\"Expected\":\"UnitsInStock\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"UnitsOnOrder\",\"Attribute\":0,\"Expected\":\"UnitsOnOrder\",\"Found\":null},{\"SubLogs\":[],\"Type\":8,\"State\":1,\"Name\":\"PK_Products\",\"Attribute\":0,\"Expected\":\"PK_Products\",\"Found\":null},{\"SubLogs\":[],\"Type\":9,\"State\":1,\"Name\":\"FK_Products_Categories\",\"Attribute\":0,\"Expected\":\"FK_Products_Categories\",\"Found\":null},{\"SubLogs\":[],\"Type\":10,\"State\":1,\"Name\":\"CategoryID\",\"Attribute\":0,\"Expected\":\"CategoriesProducts\",\"Found\":null},{\"SubLogs\":[],\"Type\":10,\"State\":1,\"Name\":\"CategoryID\",\"Attribute\":0,\"Expected\":\"CategoryID\",\"Found\":null},{\"SubLogs\":[],\"Type\":10,\"State\":1,\"Name\":\"ProductName\",\"Attribute\":0,\"Expected\":\"ProductName\",\"Found\":null},{\"SubLogs\":[],\"Type\":10,\"State\":1,\"Name\":\"SupplierID\",\"Attribute\":0,\"Expected\":\"SupplierID\",\"Found\":null},{\"SubLogs\":[],\"Type\":10,\"State\":1,\"Name\":\"SupplierID\",\"Attribute\":0,\"Expected\":\"SuppliersProducts\",\"Found\":null}],\"Type\":3,\"State\":1,\"Name\":\"Product\",\"Attribute\":0,\"Expected\":\"Products\",\"Found\":null},{\"SubLogs\":[{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"RegionId\",\"Attribute\":0,\"Expected\":\"RegionID\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"RegionDescription\",\"Attribute\":0,\"Expected\":\"RegionDescription\",\"Found\":null},{\"SubLogs\":[],\"Type\":8,\"State\":1,\"Name\":\"PK_Region\",\"Attribute\":0,\"Expected\":\"PK_Region\",\"Found\":null}],\"Type\":3,\"State\":1,\"Name\":\"Region\",\"Attribute\":0,\"Expected\":\"Region\",\"Found\":null},{\"SubLogs\":[{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"ShipperId\",\"Attribute\":0,\"Expected\":\"ShipperID\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"CompanyName\",\"Attribute\":0,\"Expected\":\"CompanyName\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"Phone\",\"Attribute\":0,\"Expected\":\"Phone\",\"Found\":null},{\"SubLogs\":[],\"Type\":8,\"State\":1,\"Name\":\"PK_Shippers\",\"Attribute\":0,\"Expected\":\"PK_Shippers\",\"Found\":null}],\"Type\":3,\"State\":1,\"Name\":\"Shipper\",\"Attribute\":0,\"Expected\":\"Shippers\",\"Found\":null},{\"SubLogs\":[{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"SupplierId\",\"Attribute\":0,\"Expected\":\"SupplierID\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"Address\",\"Attribute\":0,\"Expected\":\"Address\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"City\",\"Attribute\":0,\"Expected\":\"City\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"CompanyName\",\"Attribute\":0,\"Expected\":\"CompanyName\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"ContactName\",\"Attribute\":0,\"Expected\":\"ContactName\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"ContactTitle\",\"Attribute\":0,\"Expected\":\"ContactTitle\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"Country\",\"Attribute\":0,\"Expected\":\"Country\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"Fax\",\"Attribute\":0,\"Expected\":\"Fax\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"HomePage\",\"Attribute\":0,\"Expected\":\"HomePage\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"Phone\",\"Attribute\":0,\"Expected\":\"Phone\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"PostalCode\",\"Attribute\":0,\"Expected\":\"PostalCode\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"Region\",\"Attribute\":0,\"Expected\":\"Region\",\"Found\":null},{\"SubLogs\":[],\"Type\":8,\"State\":1,\"Name\":\"PK_Suppliers\",\"Attribute\":0,\"Expected\":\"PK_Suppliers\",\"Found\":null},{\"SubLogs\":[],\"Type\":10,\"State\":4,\"Name\":\"CompanyName\",\"Attribute\":12,\"Expected\":\"CompanyName1\",\"Found\":null},{\"SubLogs\":[],\"Type\":10,\"State\":4,\"Name\":\"PostalCode\",\"Attribute\":12,\"Expected\":\"PostalCode2\",\"Found\":null}],\"Type\":3,\"State\":1,\"Name\":\"Supplier\",\"Attribute\":0,\"Expected\":\"Suppliers\",\"Found\":null},{\"SubLogs\":[{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"TerritoryId\",\"Attribute\":0,\"Expected\":\"TerritoryID\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"RegionId\",\"Attribute\":0,\"Expected\":\"RegionID\",\"Found\":null},{\"SubLogs\":[],\"Type\":4,\"State\":1,\"Name\":\"TerritoryDescription\",\"Attribute\":0,\"Expected\":\"TerritoryDescription\",\"Found\":null},{\"SubLogs\":[],\"Type\":8,\"State\":1,\"Name\":\"PK_Territories\",\"Attribute\":0,\"Expected\":\"PK_Territories\",\"Found\":null},{\"SubLogs\":[],\"Type\":10,\"State\":4,\"Name\":\"RegionID\",\"Attribute\":12,\"Expected\":\"IX_Territories_RegionID\",\"Found\":null}],\"Type\":3,\"State\":1,\"Name\":\"Territory\",\"Attribute\":0,\"Expected\":\"Territories\",\"Found\":null}],\"Type\":2,\"State\":1,\"Name\":\"NorthwindContext\",\"Attribute\":0,\"Expected\":\"NorthwindContext\",\"Found\":null}]";
            //var o = Newtonsoft.Json.JsonConvert.DeserializeObject<List<CompareLogModel>>(s);
            //return o.AsEnumerable();
        }
    }
}